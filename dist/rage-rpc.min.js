!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.rpc=r():e.rpc=r()}("undefined"!=typeof self?self:this,function(){return function(e){var r={};function n(t){if(r[t])return r[t].exports;var c=r[t]={i:t,l:!1,exports:{}};return e[t].call(c.exports,c,c.exports,n),c.l=!0,c.exports}return n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var c in e)n.d(t,c,function(r){return e[r]}.bind(null,c));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s=1)}([function(e,r,n){"use strict";function t(){let e=46656*Math.random()|0,r=46656*Math.random()|0;return(e=("000"+e.toString(36)).slice(-3))+(r=("000"+r.toString(36)).slice(-3))}function c(){if(mp)return mp.joaat?"server":mp.game&&mp.game.joaat?"client":mp.trigger?"cef":void 0}function o(e){return JSON.stringify(e)}function s(e){return JSON.parse(e)}n.d(r,"d",function(){return t}),n.d(r,"a",function(){return c}),n.d(r,"c",function(){return o}),n.d(r,"b",function(){return s})},function(e,r,n){"use strict";n.r(r),function(e){n.d(r,"register",function(){return p}),n.d(r,"unregister",function(){return m}),n.d(r,"call",function(){return d}),n.d(r,"callServer",function(){return v}),n.d(r,"callClient",function(){return h}),n.d(r,"callBrowsers",function(){return b}),n.d(r,"callBrowser",function(){return y});var t=n(0);const c=t.a();if(!c)throw"Unknown RAGE environment";const o="PROCEDURE_NOT_FOUND",s="__rpc:process",i="__rpc:exists",a="cef"===c?window:e;let l,u;async function f(e,r,n){const t=a.__rpcListeners[e];if(!t)throw o;return t(r,n)}function p(e,r){if(2!==arguments.length)throw'register expects 2 arguments: "name" and "cb"';a.__rpcListeners[e]=r}function m(e){if(1!==arguments.length)throw'unregister expects 1 argument: "name"';a.__rpcListeners[e]=void 0}function d(e,r){return 1!==arguments.length&&2!==arguments.length?Promise.reject('call expects 1 or 2 arguments: "name" and optional "args"'):f(e,r,{environment:c})}function g(e,r,n){switch(c){case"server":return d(e,r);case"client":{const o=t.d();return new Promise((i,l)=>{a.__rpcPending[o]={resolve:i,reject:l},mp.events.callRemote(s,t.c({req:1,id:o,name:e,env:c,args:r,...n}))})}case"cef":return h("__rpc:callServer",[e,r])}}function v(e,r){return 1!==arguments.length&&2!==arguments.length?Promise.reject('callServer expects 1 or 2 arguments: "name" and optional "args"'):g(e,r,{})}function h(e,r,n){switch(c){case"client":return n=r,r=e,1!==arguments.length&&2!==arguments.length||"string"!=typeof r?Promise.reject('callClient from the client expects 1 or 2 arguments: "name" and optional "args"'):d(r,n);case"server":{if(2!==arguments.length&&3!==arguments.length||"object"!=typeof e)return Promise.reject('callClient from the server expects 2 or 3 arguments: "player", "name", and optional "args"');const o=t.d();return new Promise((i,l)=>{a.__rpcPending[o]={resolve:i,reject:l,player:e},e.call(s,[t.c({req:1,id:o,name:r,env:c,args:n})])})}case"cef":{if(n=r,r=e,1!==arguments.length&&2!==arguments.length||"string"!=typeof r)return Promise.reject('callClient from the browser expects 1 or 2 arguments: "name" and optional "args"');const o=t.d();return new Promise((e,i)=>{a.__rpcPending[o]={resolve:e,reject:i},mp.trigger(s,t.c({req:1,id:o,name:r,env:c,args:n}))})}}}function w(e,r,n,t,o){return new Promise((s,i)=>{a.__rpcPending[e]={resolve:s,reject:i},l(r,{req:1,id:e,name:n,env:c,args:t,...o},!1)})}async function _(e,r,n,s){switch(c){case"client":{n=r,r=e;const c=t.d(),a=mp.browsers.length;let l;for(let e=0;e<a;e++){const n=mp.browsers.at(e);if(await new Promise(e=>{const t=r=>{const o=r.split(":");o[0]===c&&+o[1]&&(l=n),mp.events.remove(i,t),e()};mp.events.add(i,t),n.execute(`var f = window["${i}"]; mp.trigger("${i}", "${c}:"+((f && f("${r}")) ? 1 : 0));`)}),l)break}if(l)return w(c,l,r,n,s);throw o}case"server":return h(e,"__rpc:callBrowsers",[r,n]);case"cef":return n=r,h("__rpc:callBrowsers",[r=e,n])}}function b(e,r,n){switch(c){case"client":if(1!==arguments.length&&2!==arguments.length)return Promise.reject('callBrowsers from the client expects 1 or 2 arguments: "name" and optional "args"');break;case"server":if(2!==arguments.length&&3!==arguments.length)return Promise.reject('callBrowsers from the server expects 2 or 3 arguments: "player", "name", and optional "args"');break;case"cef":if(1!==arguments.length&&2!==arguments.length)return Promise.reject('callBrowsers from the browser expects 1 or 2 arguments: "name" and optional "args"')}return _(e,r,n,{})}function y(e,r,n){if("client"!==c)return Promise.reject("callBrowser can only be used in the client environment");if(2!==arguments.length&&3!==arguments.length)return Promise.reject('callBrowser expects 2 or 3 arguments: "browser", "name", and optional "args"');return w(t.d(),e,r,n,{})}a[s]||(a.__rpcListeners={},a.__rpcPending={},a[s]=((...e)=>{let r=e[0];"server"===c&&(r=e[1]);const n=t.b(r);if(n.req){const r={id:n.id,environment:n.fenv||n.env};"server"===c&&(r.player=e[0]);const o=f(n.name,n.args,r),i={ret:1,id:n.id,env:c};switch(c){case"server":o.then(e=>{r.player.call(s,[t.c({...i,res:e})])}).catch(e=>{r.player.call(s,[t.c({...i,err:e})])});break;case"client":"server"===n.env?o.then(e=>{mp.events.callRemote(s,t.c({...i,res:e}))}).catch(e=>{mp.events.callRemote(s,t.c({...i,err:e}))}):"cef"===n.env&&o.then(e=>{u({...i,res:e},!0)}).catch(e=>{u({...i,err:e},!0)});break;case"cef":o.then(e=>{mp.trigger(s,t.c({...i,res:e}))}).catch(e=>{mp.trigger(s,t.c({...i,err:e}))})}}else if(n.ret){const r=a.__rpcPending[n.id];if("server"===c&&r.player!==e[0])return;r&&(n.err?r.reject(n.err):r.resolve(n.res),a.__rpcPending[n.id]=void 0)}}),"cef"===c?window[i]=(e=>!!a.__rpcListeners[e]):(mp.events.add(s,a[s]),"client"===c&&(p("__rpc:callServer",([e,r],n)=>g(e,r,{fenv:n.environment})),p("__rpc:callBrowsers",([e,r],n)=>_(e,r,null,{fenv:n.environment}))))),"client"===c&&(l=((e,r,n)=>{const c=t.c(r);e.execute(`var process = window["${s}"]; if(process){ process('${c}'); }else{ ${n?"":`mp.trigger("${s}", '{"ret":1,"id":"${r.id}","err":"${o}","env":"cef"}');`} }`)}),u=((e,r)=>{mp.browsers.forEach(n=>l(n,e,r))}))}.call(this,n(2))},function(e,r){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n}])});